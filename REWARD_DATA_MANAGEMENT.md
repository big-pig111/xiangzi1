# 奖励数据管理功能文档

## 概述

奖励数据管理功能是后台管理系统的重要组成部分，用于管理游戏中的奖励数据，包括主倒计时奖励、持仓奖励和领取历史。

## 功能特性

### 1. 奖励数据统计
- **主倒计时奖励**: 显示已生成的主倒计时奖励轮次数量
- **持仓奖励**: 显示已生成的持仓奖励轮次数量
- **已领取奖励**: 显示已领取的奖励次数
- **总发放积分**: 显示所有奖励的总积分数量

### 2. 最近奖励记录
- 显示最近5个奖励记录
- 包含奖励类型、时间、获得者、积分和状态信息
- 实时更新显示

### 3. 奖励数据查看
- 查看所有奖励数据（主倒计时和持仓奖励）
- 按时间排序显示
- 包含详细的奖励信息

### 4. 奖励数据导出
- 导出奖励数据为CSV格式
- 包含类型、时间、获得者、积分、状态、轮次等信息
- 文件名格式：`reward_data_YYYY-MM-DD.csv`

### 5. 奖励领取历史
- 查看所有奖励领取历史记录
- 包含领取类型、时间、钱包地址、积分、轮次等信息
- 按时间排序显示

### 6. 奖励数据清除
- 清除所有奖励数据（主倒计时奖励、持仓奖励、领取历史）
- 带确认对话框，防止误操作

## 数据结构

### 主倒计时奖励 (mainCountdownRewards)
```javascript
{
    winner: "钱包地址",
    amount: 10000,
    claimed: false,
    timestamp: "2024-01-01T00:00:00.000Z",
    round: 1
}
```

### 持仓奖励 (holdingRewards)
```javascript
{
    eligibleAddresses: ["地址1", "地址2", "地址3"],
    amount: 3000,
    claimed: false,
    timestamp: "2024-01-01T00:00:00.000Z",
    round: 1
}
```

### 领取历史 (rewardHistory)
```javascript
{
    type: "Main Countdown Winner (2 rounds)",
    amount: 20000,
    timestamp: "2024-01-01T00:00:00.000Z",
    address: "钱包地址",
    rounds: 2
}
```

## 使用方法

### 1. 访问奖励数据管理面板
1. 打开后台管理页面 (`admin.html`)
2. 找到"奖励数据管理"面板
3. 查看当前奖励统计信息

### 2. 查看奖励数据
1. 点击"查看奖励数据"按钮
2. 在弹出的模态框中查看所有奖励记录
3. 可以查看奖励类型、时间、获得者、积分、状态等信息

### 3. 导出奖励数据
1. 点击"导出奖励数据"按钮
2. 系统会自动下载CSV格式的奖励数据文件
3. 文件名包含当前日期

### 4. 查看领取历史
1. 点击"查看领取历史"按钮
2. 在弹出的模态框中查看所有领取记录
3. 包含领取类型、时间、钱包地址、积分、轮次等信息

### 5. 清除奖励数据
1. 点击"清除奖励数据"按钮
2. 在确认对话框中点击"确认"
3. 所有奖励数据将被清除（不可恢复）

## 测试功能

### 测试页面
使用 `test_reward_data_management.html` 页面进行功能测试：

1. **设置测试数据**
   - 设置测试钱包
   - 添加主倒计时奖励
   - 添加持仓奖励
   - 添加领取历史

2. **测试后台功能**
   - 打开后台页面
   - 测试奖励统计
   - 测试最近奖励显示

3. **实时监控**
   - 查看当前数据统计
   - 查看最近奖励记录
   - 查看测试日志

## 技术实现

### 前端实现
- 使用 `localStorage` 存储奖励数据
- 实时更新统计信息和显示
- 响应式设计，支持不同屏幕尺寸

### 后端管理
- 集成到现有的后台管理系统
- 使用统一的模态框组件
- 支持CSV导出功能

### 数据同步
- 每5秒自动更新奖励数据统计
- 实时同步最近奖励记录
- 自动更新状态指示器

## 注意事项

1. **数据安全**: 奖励数据存储在浏览器的 `localStorage` 中，清除浏览器数据会导致数据丢失
2. **数据限制**: 建议定期清理旧的奖励数据以保持系统性能
3. **备份建议**: 重要数据建议定期导出备份
4. **权限控制**: 只有管理员可以访问奖励数据管理功能

## 故障排除

### 常见问题

1. **奖励数据不显示**
   - 检查 `localStorage` 中是否存在奖励数据
   - 确认数据格式是否正确

2. **统计信息不更新**
   - 检查后台管理系统是否正常运行
   - 确认自动更新功能是否启用

3. **导出功能失败**
   - 检查浏览器是否支持文件下载
   - 确认数据格式是否正确

### 调试方法

1. 打开浏览器开发者工具
2. 查看控制台错误信息
3. 检查 `localStorage` 中的数据
4. 使用测试页面验证功能

## 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 实现基本的奖励数据管理功能
- 支持查看、导出、清除操作
- 集成到后台管理系统

---

**注意**: 此功能仅用于演示目的，实际使用时请根据具体需求进行调整。 