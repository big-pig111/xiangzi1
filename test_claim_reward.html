<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claim Reward Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a1a;
            color: white;
        }
        
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            border: 2px solid #333;
        }
        
        .test-btn {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }
        
        .test-btn:hover {
            background: #45a049;
        }
        
        .log {
            background: #000;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-left: 3px solid #333;
        }
        
        .log-entry.success {
            border-left-color: #4CAF50;
            color: #4CAF50;
        }
        
        .log-entry.error {
            border-left-color: #f44336;
            color: #f44336;
        }
        
        .log-entry.info {
            border-left-color: #2196F3;
            color: #2196F3;
        }
    </style>
</head>
<body>
    <h1>üéÅ Claim Reward Test</h1>
    
    <div class="test-section">
        <h2>Test Claim Reward Modal</h2>
        <button class="test-btn" onclick="testShowClaimReward()">Show Claim Reward</button>
        <button class="test-btn" onclick="testCloseClaimReward()">Close Claim Reward</button>
        <button class="test-btn" onclick="testToggleClaimReward()">Toggle Claim Reward</button>
        <button class="test-btn" onclick="clearLog()">Clear Log</button>
    </div>
    
    <div class="test-section">
        <h2>Test Reward Data</h2>
        <button class="test-btn" onclick="testSetMainCountdownReward()">Set Main Countdown Winner</button>
        <button class="test-btn" onclick="testSetHoldingReward()">Set Holding Reward</button>
        <button class="test-btn" onclick="testClearRewards()">Clear All Rewards</button>
    </div>
    
    <div class="test-section">
        <h2>Test Log</h2>
        <div id="log" class="log"></div>
    </div>

    <!-- JavaScript Modules -->
    <script src="js/modules/ClaimRewardModal.js"></script>
    
    <script>
        let claimRewardModal = null;
        
        function log(message, type = 'info') {
            const logEl = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logEl.appendChild(entry);
            logEl.scrollTop = logEl.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }
        
        function testShowClaimReward() {
            log('Testing show claim reward...', 'info');
            
            try {
                if (!claimRewardModal) {
                    claimRewardModal = new ClaimRewardModal();
                    log('Created new ClaimRewardModal instance', 'success');
                }
                
                claimRewardModal.show();
                log('Claim reward modal shown successfully', 'success');
            } catch (error) {
                log(`Error showing claim reward: ${error.message}`, 'error');
            }
        }
        
        function testCloseClaimReward() {
            log('Testing close claim reward...', 'info');
            
            try {
                if (claimRewardModal) {
                    claimRewardModal.close();
                    log('Claim reward modal closed successfully', 'success');
                } else {
                    log('No claim reward modal instance found', 'error');
                }
            } catch (error) {
                log(`Error closing claim reward: ${error.message}`, 'error');
            }
        }
        
        function testToggleClaimReward() {
            log('Testing toggle claim reward...', 'info');
            
            try {
                if (!claimRewardModal) {
                    claimRewardModal = new ClaimRewardModal();
                    log('Created new ClaimRewardModal instance', 'success');
                }
                
                claimRewardModal.toggle();
                log('Claim reward modal toggled successfully', 'success');
            } catch (error) {
                log(`Error toggling claim reward: ${error.message}`, 'error');
            }
        }
        
        function testSetMainCountdownReward() {
            log('Setting main countdown reward data...', 'info');
            
            try {
                // Simulate wallet connection
                const testAddress = 'TestAddress123456789';
                localStorage.setItem('walletConnection', JSON.stringify({
                    type: 'phantom',
                    address: testAddress,
                    timestamp: Date.now()
                }));
                
                // Set multiple main countdown rewards (simulating multiple rounds)
                const mainCountdownRewards = [
                    {
                        winner: testAddress,
                        amount: 10000,
                        claimed: false,
                        timestamp: new Date(Date.now() - 86400000).toISOString(), // 1 day ago
                        round: 1
                    },
                    {
                        winner: testAddress,
                        amount: 10000,
                        claimed: false,
                        timestamp: new Date(Date.now() - 43200000).toISOString(), // 12 hours ago
                        round: 2
                    },
                    {
                        winner: 'OtherAddress999',
                        amount: 10000,
                        claimed: false,
                        timestamp: new Date().toISOString(),
                        round: 3
                    }
                ];
                localStorage.setItem('mainCountdownRewards', JSON.stringify(mainCountdownRewards));
                
                log(`Main countdown rewards set for address: ${testAddress} (2 rounds available)`, 'success');
            } catch (error) {
                log(`Error setting main countdown reward: ${error.message}`, 'error');
            }
        }
        
        function testSetHoldingReward() {
            log('Setting holding reward data...', 'info');
            
            try {
                // Get current wallet address
                const savedConnection = localStorage.getItem('walletConnection');
                if (!savedConnection) {
                    log('No wallet connected, setting test address', 'info');
                    const testAddress = 'TestAddress123456789';
                    localStorage.setItem('walletConnection', JSON.stringify({
                        type: 'phantom',
                        address: testAddress,
                        timestamp: Date.now()
                    }));
                }
                
                const connection = JSON.parse(localStorage.getItem('walletConnection'));
                const address = connection.address;
                
                // Set multiple holding rewards (simulating multiple rounds)
                const holdingRewards = [
                    {
                        eligibleAddresses: [address],
                        amount: 3000,
                        claimed: false,
                        timestamp: new Date(Date.now() - 86400000).toISOString(), // 1 day ago
                        round: 1
                    },
                    {
                        eligibleAddresses: [address],
                        amount: 3000,
                        claimed: false,
                        timestamp: new Date(Date.now() - 43200000).toISOString(), // 12 hours ago
                        round: 2
                    },
                    {
                        eligibleAddresses: [address],
                        amount: 3000,
                        claimed: false,
                        timestamp: new Date().toISOString(),
                        round: 3
                    }
                ];
                localStorage.setItem('holdingRewards', JSON.stringify(holdingRewards));
                
                log(`Holding rewards set for address: ${address} (3 rounds available)`, 'success');
            } catch (error) {
                log(`Error setting holding reward: ${error.message}`, 'error');
            }
        }
        
        function testClearRewards() {
            log('Clearing all reward data...', 'info');
            
            try {
                localStorage.removeItem('mainCountdownRewards');
                localStorage.removeItem('holdingRewards');
                localStorage.removeItem('rewardHistory');
                localStorage.removeItem('walletConnection');
                
                log('All reward data cleared successfully', 'success');
            } catch (error) {
                log(`Error clearing rewards: ${error.message}`, 'error');
            }
        }
        
        // Initialize
        log('Claim reward test page loaded', 'info');
        log('This page tests the claim reward modal functionality', 'info');
        
        // Test if ClaimRewardModal is available
        if (typeof ClaimRewardModal !== 'undefined') {
            log('ClaimRewardModal class is available', 'success');
        } else {
            log('ClaimRewardModal class is not available', 'error');
        }
    </script>
</body>
</html> 